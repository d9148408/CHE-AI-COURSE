# Unit13 é›†æˆå­¸ç¿’æ–¹æ³• (Ensemble Learning Methods)

## ğŸ“š å–®å…ƒç°¡ä»‹

åœ¨å‰ä¸‰å€‹å–®å…ƒä¸­ï¼Œæˆ‘å€‘å­¸ç¿’äº†å„ç¨®å–®ä¸€æ¨¡å‹ï¼šç·šæ€§æ¨¡å‹ (Unit10)ã€éç·šæ€§æ¨¡å‹ (Unit11)ã€åˆ†é¡æ¨¡å‹ (Unit12)ã€‚æ¯å€‹å–®ä¸€æ¨¡å‹éƒ½æœ‰å…¶å„ªå‹¢èˆ‡é™åˆ¶ã€‚é›†æˆå­¸ç¿’ (Ensemble Learning) æ˜¯æ©Ÿå™¨å­¸ç¿’ä¸­æœ€å¼·å¤§ä¸”å»£æ³›æ‡‰ç”¨çš„æŠ€è¡“ä¹‹ä¸€ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯ã€Œä¸‰å€‹è‡­çš®åŒ ï¼Œå‹éä¸€å€‹è«¸è‘›äº®ã€â€”â€”é€éçµ„åˆå¤šå€‹åŸºç¤å­¸ç¿’å™¨çš„é æ¸¬çµæœä¾†ç²å¾—æ›´å¥½çš„é æ¸¬æ€§èƒ½ã€‚

é›†æˆå­¸ç¿’èƒ½å¤ é¡¯è‘—æå‡æ¨¡å‹çš„æº–ç¢ºæ€§å’Œç©©å®šæ€§ï¼ŒåŒæ™‚é™ä½éæ“¬åˆé¢¨éšªã€‚åœ¨å¯¦å‹™æ‡‰ç”¨ä¸­ï¼Œé›†æˆæ¨¡å‹ï¼ˆå¦‚ Random Forestã€XGBoostã€LightGBMã€CatBoostï¼‰é€šå¸¸æ˜¯å„ç¨®æ©Ÿå™¨å­¸ç¿’ç«¶è³½å’Œå·¥æ¥­é …ç›®çš„é¦–é¸æ–¹æ³•ã€‚

æœ¬å–®å…ƒæ¶µè“‹ä¸‰å¤§é¡é›†æˆå­¸ç¿’æ–¹æ³•åŠå…¶ä»£è¡¨ç®—æ³•ï¼š
- **Bagging æ–¹æ³•**ï¼šRandom Forestï¼ˆéš¨æ©Ÿæ£®æ—ï¼‰
- **Boosting æ–¹æ³•**ï¼šXGBoostã€LightGBMã€CatBoostï¼ˆä¸‰å¤§ä¸»æµæ¢¯åº¦æå‡æ¡†æ¶ï¼‰
- **Stacking æ–¹æ³•**ï¼šå †ç–Šé›†æˆï¼ˆStacking Ensembleï¼‰

é€éç³»çµ±æ€§å­¸ç¿’é€™äº›æ–¹æ³•ï¼Œå­¸å“¡å°‡æŒæ¡ç›®å‰å·¥æ¥­ç•Œæœ€å¯¦ç”¨çš„æ©Ÿå™¨å­¸ç¿’æŠ€è¡“ï¼Œç‚ºå¾ŒçºŒçš„æ¨¡å‹è©•ä¼°èˆ‡é¸æ“‡ (Unit14) å»ºç«‹å …å¯¦åŸºç¤ã€‚

---

## ğŸ¯ å­¸ç¿’ç›®æ¨™

å®Œæˆæœ¬å–®å…ƒå¾Œï¼Œæ‚¨å°‡èƒ½å¤ ï¼š

1. **ç†è§£é›†æˆå­¸ç¿’çš„æ ¸å¿ƒæ¦‚å¿µ**ï¼šåå·®-æ–¹å·®åˆ†è§£ã€å¤šæ¨£æ€§åŸå‰‡ã€çµ„åˆç­–ç•¥
2. **æŒæ¡ä¸‰å¤§é›†æˆå­¸ç¿’æ–¹æ³•**ï¼šç†è§£ Baggingã€Boostingã€Stacking çš„åŸç†èˆ‡å·®ç•°
3. **é¸æ“‡åˆé©çš„é›†æˆæ¨¡å‹**ï¼šæ ¹æ“šè³‡æ–™ç‰¹æ€§å’Œæ‡‰ç”¨éœ€æ±‚é¸æ“‡ Random Forestã€XGBoostã€LightGBMã€CatBoost æˆ– Stacking
4. **å¯¦ä½œé›†æˆå­¸ç¿’æ¨¡å‹**ï¼šä½¿ç”¨ scikit-learnã€XGBoostã€LightGBMã€CatBoost å»ºç«‹é«˜æ€§èƒ½æ¨¡å‹
5. **æ‡‰ç”¨æ–¼åŒ–å·¥é ˜åŸŸ**ï¼šè§£æ±ºè¤‡é›œçš„é æ¸¬èˆ‡åˆ†é¡å•é¡Œï¼Œé”åˆ°å·¥æ¥­ç´šç²¾åº¦

---

## ğŸ“– å–®å…ƒå…§å®¹æ¶æ§‹

### 1ï¸âƒ£ ç¸½è¦½ç¯‡ï¼šé›†æˆå­¸ç¿’åŸºç¤ â­

**æŠ•å½±ç‰‡æª”æ¡ˆ**ï¼š[Unit13_Ensemble_Learning_Overview.pdf](Unit13_Ensemble_Learning_Overview.pdf)
**è¬›ç¾©æª”æ¡ˆ**ï¼š[Unit13_Ensemble_Learning_Overview.md](Unit13_Ensemble_Learning_Overview.md)
**ç¨‹å¼ç¯„ä¾‹**ï¼š[Unit13_Ensemble_Learning_Overview.ipynb](Unit13_Ensemble_Learning_Overview.ipynb)

**å…§å®¹é‡é»**ï¼š
- é›†æˆå­¸ç¿’çš„å®šç¾©èˆ‡æ ¸å¿ƒå„ªå‹¢
- ç†è«–åŸºç¤ï¼š
  - åå·®-æ–¹å·®åˆ†è§£ (Bias-Variance Decomposition)
  - å¤šæ¨£æ€§åŸå‰‡ (Diversity Principle)
- é›†æˆå­¸ç¿’çš„ä¸‰å¤§é¡åˆ¥ï¼š
  - **Bagging**ï¼šé™ä½æ–¹å·®ï¼Œä¸¦è¡Œè¨“ç·´ï¼Œä»£è¡¨ç®—æ³• Random Forest
  - **Boosting**ï¼šé™ä½åå·®ï¼Œåºåˆ—è¨“ç·´ï¼Œä»£è¡¨ç®—æ³• XGBoost/LightGBM/CatBoost
  - **Stacking**ï¼šå…¨é¢æå‡ï¼Œå¤šå±¤è¨“ç·´ï¼Œçµåˆç•°è³ªæ¨¡å‹
- åŒ–å·¥é ˜åŸŸæ‡‰ç”¨å ´æ™¯ï¼šé«˜ç²¾åº¦é æ¸¬ã€ç©©å¥å»ºæ¨¡ã€ç‰¹å¾µé‡è¦æ€§åˆ†æ
- é›†æˆå­¸ç¿’ vs. å–®ä¸€æ¨¡å‹æ¯”è¼ƒ

**é©åˆè®€è€…**ï¼šæ‰€æœ‰å­¸å“¡ï¼Œ**å»ºè­°æœ€å…ˆé–±è®€**ä»¥å»ºç«‹æ•´é«”æ¦‚å¿µ

---

### 2ï¸âƒ£ Random Forestï¼ˆéš¨æ©Ÿæ£®æ—ï¼‰â­

**æª”æ¡ˆ**ï¼š
- æŠ•å½±ç‰‡ï¼š[Unit13_Random_Forest.pdf](Unit13_Random_Forest.pdf)
- è¬›ç¾©ï¼š[Unit13_Random_Forest.md](Unit13_Random_Forest.md)
- å›æ­¸ç¯„ä¾‹ï¼š[Unit13_Random_Forest_Regression.ipynb](Unit13_Random_Forest_Regression.ipynb)
- åˆ†é¡ç¯„ä¾‹ï¼š[Unit13_Random_Forest_Classifier.ipynb](Unit13_Random_Forest_Classifier.ipynb)

**å…§å®¹é‡é»**ï¼š
- **æ¼”ç®—æ³•åŸç†**ï¼š
  - Bagging (Bootstrap Aggregating) + éš¨æ©Ÿç‰¹å¾µé¸æ“‡
  - ä¸¦è¡Œè¨“ç·´å¤šæ£µæ±ºç­–æ¨¹
  - å›æ­¸ï¼šå¹³å‡é æ¸¬å€¼ï¼›åˆ†é¡ï¼šæŠ•ç¥¨æ©Ÿåˆ¶
  - Out-of-Bag (OOB) èª¤å·®ä¼°è¨ˆ
  
- **å¯¦ä½œæŠ€è¡“**ï¼š
  - scikit-learn `RandomForestRegressor` / `RandomForestClassifier` ä½¿ç”¨
  - é—œéµè¶…åƒæ•¸ï¼š`n_estimators`ã€`max_depth`ã€`max_features`ã€`min_samples_split`ã€`bootstrap`
  - ç‰¹å¾µé‡è¦æ€§åˆ†æ
  - OOB Score è©•ä¼°
  - å¹³è¡ŒåŒ–è¨“ç·´ (`n_jobs=-1`)
  
- **åŒ–å·¥æ‡‰ç”¨æ¡ˆä¾‹**ï¼š
  - **å¤šè®Šæ•¸è£½ç¨‹é æ¸¬**ï¼šåŒæ™‚è€ƒæ…®å¤šå€‹æ“ä½œè®Šæ•¸çš„äº¤äº’ä½œç”¨
  - **ç©©å¥é æ¸¬ç³»çµ±**ï¼šå°é›œè¨Šå’Œç•°å¸¸å€¼ä¸æ•æ„Ÿ
  - **ç‰¹å¾µç¯©é¸**ï¼šè­˜åˆ¥å°é æ¸¬æœ€é‡è¦çš„è£½ç¨‹è®Šæ•¸
  
- **æ¼”ç®—æ³•ç‰¹æ€§**ï¼š
  - âœ… å„ªé»ï¼šé«˜ç²¾åº¦ã€æŠ—éæ“¬åˆã€è‡ªå‹•ç‰¹å¾µé¸æ“‡ã€è™•ç†ç¼ºå¤±å€¼ã€ä¸¦è¡Œè¨“ç·´å¿«é€Ÿã€æä¾›ç‰¹å¾µé‡è¦æ€§
  - âŒ ç¼ºé»ï¼šæ¨¡å‹è¼ƒå¤§ï¼ˆå„²å­˜å¤šæ£µæ¨¹ï¼‰ã€é æ¸¬é€Ÿåº¦è¼ƒå–®æ¨¹æ…¢ã€å¯è§£é‡‹æ€§ä½æ–¼å–®ä¸€æ±ºç­–æ¨¹

**é©åˆå ´æ™¯**ï¼šè¿½æ±‚ç©©å¥é«˜ç²¾åº¦ã€è³‡æ–™æœ‰é›œè¨Šã€éœ€è¦ç‰¹å¾µé‡è¦æ€§åˆ†æ

---

### 3ï¸âƒ£ XGBoost (eXtreme Gradient Boosting) â­

**æª”æ¡ˆ**ï¼š
- æŠ•å½±ç‰‡ï¼š[Unit13_XGBoost.pdf](Unit13_XGBoost.pdf)
- è¬›ç¾©ï¼š[Unit13_XGBoost.md](Unit13_XGBoost.md)
- å›æ­¸ç¯„ä¾‹ï¼š[Unit13_XGBoost_Regression.ipynb](Unit13_XGBoost_Regression.ipynb)
- åˆ†é¡ç¯„ä¾‹ï¼š[Unit13_XGBoost_Classification.ipynb](Unit13_XGBoost_Classification.ipynb)

**å…§å®¹é‡é»**ï¼š
- **æ¼”ç®—æ³•åŸç†**ï¼š
  - Gradient Boosting çš„å„ªåŒ–å¯¦ç¾
  - äºŒéšæ³°å‹’å±•é–‹è¿‘ä¼¼æå¤±å‡½æ•¸
  - æ­£å‰‡åŒ–é …é˜²æ­¢éæ“¬åˆ
  - æ¨¹çš„å‰ªæç­–ç•¥ï¼ˆmax_depthã€min_child_weightã€gammaï¼‰
  
- **å¯¦ä½œæŠ€è¡“**ï¼š
  - `xgboost` å¥—ä»¶ä½¿ç”¨ï¼š`XGBRegressor` / `XGBClassifier`
  - é—œéµè¶…åƒæ•¸ï¼š
    - `n_estimators`ã€`learning_rate`ã€`max_depth`ã€`subsample`ã€`colsample_bytree`
    - `reg_alpha` (L1)ã€`reg_lambda` (L2)
  - Early Stopping æ©Ÿåˆ¶
  - ç‰¹å¾µé‡è¦æ€§åˆ†æï¼ˆgainã€weightã€coverï¼‰
  - åŸç”Ÿè™•ç†ç¼ºå¤±å€¼
  - GPU åŠ é€Ÿè¨“ç·´
  
- **åŒ–å·¥æ‡‰ç”¨æ¡ˆä¾‹**ï¼š
  - **æ©Ÿå™¨å­¸ç¿’ç«¶è³½ç´šç²¾åº¦**ï¼šKaggle ç«¶è³½å¸¸å‹è»
  - **è¤‡é›œéç·šæ€§å»ºæ¨¡**ï¼šæ•æ‰ç‰¹å¾µé–“çš„é«˜éšäº¤äº’ä½œç”¨
  - **å¤§è¦æ¨¡æ•¸æ“šé æ¸¬**ï¼šé«˜æ•ˆè™•ç†æ•¸åè¬ç­†è³‡æ–™
  
- **æ¼”ç®—æ³•ç‰¹æ€§**ï¼š
  - âœ… å„ªé»ï¼šæ¥µé«˜ç²¾åº¦ã€è±å¯Œçš„è¶…åƒæ•¸ã€åŸç”Ÿè™•ç†ç¼ºå¤±å€¼ã€æ”¯æ´ GPUã€é–‹æºç¤¾ç¾¤æ´»èº
  - âŒ ç¼ºé»ï¼šè¶…åƒæ•¸èª¿æ•´è¤‡é›œã€è¨“ç·´æ™‚é–“è¼ƒé•·ã€å®¹æ˜“éæ“¬åˆï¼ˆéœ€ä»”ç´°èª¿åƒï¼‰

**é©åˆå ´æ™¯**ï¼šè¿½æ±‚æœ€é«˜ç²¾åº¦ã€é¡˜æ„æŠ•å…¥èª¿åƒæ™‚é–“ã€çµæ§‹åŒ–æ•¸æ“š

---

### 4ï¸âƒ£ LightGBM (Light Gradient Boosting Machine)

**æª”æ¡ˆ**ï¼š
- æŠ•å½±ç‰‡ï¼š[Unit13_LightGBM.pdf](Unit13_LightGBM.pdf)
- è¬›ç¾©ï¼š[Unit13_LightGBM.md](Unit13_LightGBM.md)
- å›æ­¸ç¯„ä¾‹ï¼š[Unit13_LightGBM_Regression.ipynb](Unit13_LightGBM_Regression.ipynb)
- åˆ†é¡ç¯„ä¾‹ï¼š[Unit13_LightGBM_Classification.ipynb](Unit13_LightGBM_Classification.ipynb)

**å…§å®¹é‡é»**ï¼š
- **æ¼”ç®—æ³•åŸç†**ï¼š
  - åŸºæ–¼ç›´æ–¹åœ–çš„æ¢¯åº¦æå‡ (Histogram-based Gradient Boosting)
  - Leaf-wise (Best-first) æ¨¹ç”Ÿé•·ç­–ç•¥
  - GOSS (Gradient-based One-Side Sampling) é™ä½æ¨£æœ¬æ•¸
  - EFB (Exclusive Feature Bundling) é™ä½ç‰¹å¾µæ•¸
  
- **å¯¦ä½œæŠ€è¡“**ï¼š
  - `lightgbm` å¥—ä»¶ä½¿ç”¨ï¼š`LGBMRegressor` / `LGBMClassifier`
  - é—œéµè¶…åƒæ•¸ï¼š
    - `n_estimators`ã€`learning_rate`ã€`num_leaves`ã€`max_depth`
    - `min_data_in_leaf`ã€`bagging_fraction`ã€`feature_fraction`
  - é¡åˆ¥ç‰¹å¾µåŸç”Ÿæ”¯æ´ (`categorical_feature`)
  - Early Stopping èˆ‡å­¸ç¿’æ›²ç·šç›£æ§
  - è¨˜æ†¶é«”å„ªåŒ–èˆ‡é€Ÿåº¦å„ªåŒ–
  
- **åŒ–å·¥æ‡‰ç”¨æ¡ˆä¾‹**ï¼š
  - **å¤§è¦æ¨¡æ™‚é–“åºåˆ—é æ¸¬**ï¼šå¿«é€Ÿè¨“ç·´å¤§é‡æ­·å²è£½ç¨‹æ•¸æ“š
  - **å³æ™‚é æ¸¬ç³»çµ±**ï¼šè¨“ç·´èˆ‡é æ¸¬é€Ÿåº¦å„ªå‹¢
  - **é«˜ç¶­ç‰¹å¾µå»ºæ¨¡**ï¼šæœ‰æ•ˆè™•ç†æ•¸ç™¾å€‹ç‰¹å¾µ
  
- **æ¼”ç®—æ³•ç‰¹æ€§**ï¼š
  - âœ… å„ªé»ï¼šè¨“ç·´é€Ÿåº¦æ¥µå¿«ã€è¨˜æ†¶é«”å ç”¨å°ã€åŸç”Ÿæ”¯æ´é¡åˆ¥ç‰¹å¾µã€ç²¾åº¦èˆ‡ XGBoost ç›¸ç•¶
  - âŒ ç¼ºé»ï¼šå°æ•¸æ“šé›†å®¹æ˜“éæ“¬åˆã€num_leaves åƒæ•¸éœ€è¬¹æ…è¨­å®š

**é©åˆå ´æ™¯**ï¼šå¤§è¦æ¨¡æ•¸æ“šã€è¨“ç·´é€Ÿåº¦è¦æ±‚é«˜ã€æœ‰é¡åˆ¥ç‰¹å¾µ

---

### 5ï¸âƒ£ CatBoost (Categorical Boosting)

**æª”æ¡ˆ**ï¼š
- æŠ•å½±ç‰‡ï¼š[Unit13_CatBoost.pdf](Unit13_CatBoost.pdf)
- è¬›ç¾©ï¼š[Unit13_CatBoost.md](Unit13_CatBoost.md)
- å›æ­¸ç¯„ä¾‹ï¼š[Unit13_CatBoost_Regression.ipynb](Unit13_CatBoost_Regression.ipynb)
- åˆ†é¡ç¯„ä¾‹ï¼š[Unit13_CatBoost_Classification.ipynb](Unit13_CatBoost_Classification.ipynb)

**å…§å®¹é‡é»**ï¼š
- **æ¼”ç®—æ³•åŸç†**ï¼š
  - å„ªåŒ–çš„é¡åˆ¥ç‰¹å¾µè™•ç†ï¼ˆOrdered Target Encodingï¼‰
  - å°ç¨±æ¨¹ (Oblivious Trees) çµæ§‹
  - Ordered Boosting æ¸›å°‘é æ¸¬åç§» (Prediction Shift)
  - å…§å»ºè™•ç†éæ“¬åˆæ©Ÿåˆ¶
  
- **å¯¦ä½œæŠ€è¡“**ï¼š
  - `catboost` å¥—ä»¶ä½¿ç”¨ï¼š`CatBoostRegressor` / `CatBoostClassifier`
  - é—œéµè¶…åƒæ•¸ï¼š
    - `iterations`ã€`learning_rate`ã€`depth`ã€`l2_leaf_reg`
    - `border_count`ã€`bagging_temperature`
  - é¡åˆ¥ç‰¹å¾µè‡ªå‹•è™•ç† (`cat_features`)
  - æ–‡å­—ç‰¹å¾µæ”¯æ´ (`text_features`)
  - å…§å»ºè¦–è¦ºåŒ–å·¥å…·
  - GPU åŠ é€Ÿ
  
- **åŒ–å·¥æ‡‰ç”¨æ¡ˆä¾‹**ï¼š
  - **æ··åˆç‰¹å¾µé¡å‹å»ºæ¨¡**ï¼šåŒæ™‚æœ‰é€£çºŒè®Šæ•¸å’Œé¡åˆ¥è®Šæ•¸ï¼ˆå¦‚åæ‡‰é¡å‹ã€å‚¬åŒ–åŠ‘ç¨®é¡ï¼‰
  - **é è¨­åƒæ•¸å³é«˜æ€§èƒ½**ï¼šèª¿åƒè² æ“”æœ€å°
  - **ç”Ÿç”¢ç’°å¢ƒéƒ¨ç½²**ï¼šæ¨¡å‹æª”æ¡ˆå°ã€æ¨è«–é€Ÿåº¦å¿«
  
- **æ¼”ç®—æ³•ç‰¹æ€§**ï¼š
  - âœ… å„ªé»ï¼šé¡åˆ¥ç‰¹å¾µè™•ç†æœ€ä½³ã€é è¨­åƒæ•¸è¡¨ç¾å„ªç•°ã€è¼ƒå°‘éæ“¬åˆã€å…§å»ºè¦–è¦ºåŒ–
  - âŒ ç¼ºé»ï¼šè¨“ç·´é€Ÿåº¦ç•¥æ…¢æ–¼ LightGBMã€ç¤¾ç¾¤ç”Ÿæ…‹ç›¸å°è¼ƒå°

**é©åˆå ´æ™¯**ï¼šæœ‰é¡åˆ¥ç‰¹å¾µã€å¸Œæœ›æ¸›å°‘èª¿åƒå·¥ä½œã€è¿½æ±‚ç©©å®šé«˜æ€§èƒ½

---

### 6ï¸âƒ£ Stackingï¼ˆå †ç–Šé›†æˆï¼‰

**æª”æ¡ˆ**ï¼š
- æŠ•å½±ç‰‡ï¼š[Unit13_Stacking.pdf](Unit13_Stacking.pdf)
- è¬›ç¾©ï¼š[Unit13_Stacking.md](Unit13_Stacking.md)
- å›æ­¸ç¯„ä¾‹ï¼š[Unit13_Stacking_Regression.ipynb](Unit13_Stacking_Regression.ipynb)
- åˆ†é¡ç¯„ä¾‹ï¼š[Unit13_Stacking_Classification.ipynb](Unit13_Stacking_Classification.ipynb)

**å…§å®¹é‡é»**ï¼š
- **æ¼”ç®—æ³•åŸç†**ï¼š
  - å¤šå±¤æ¬¡é›†æˆå­¸ç¿’æ¶æ§‹
  - åŸºç¤å­¸ç¿’å™¨ (Base Learners) + å…ƒå­¸ç¿’å™¨ (Meta-learner)
  - äº¤å‰é©—è­‰ç”Ÿæˆå…ƒç‰¹å¾µé¿å…è³‡è¨Šæ´©æ¼
  - çµåˆç•°è³ªæ¨¡å‹çš„å¤šæ¨£æ€§
  
- **å¯¦ä½œæŠ€è¡“**ï¼š
  - scikit-learn `StackingRegressor` / `StackingClassifier` ä½¿ç”¨
  - åŸºç¤å­¸ç¿’å™¨é¸æ“‡ç­–ç•¥ï¼ˆç•°è³ªæ€§ã€äº’è£œæ€§ï¼‰
  - å…ƒå­¸ç¿’å™¨é¸æ“‡ï¼ˆé€šå¸¸é¸æ“‡ç°¡å–®ç·šæ€§æ¨¡å‹ï¼‰
  - `cv` åƒæ•¸è¨­å®šï¼ˆäº¤å‰é©—è­‰æŠ˜æ•¸ï¼‰
  - `passthrough` ä¿ç•™åŸå§‹ç‰¹å¾µ
  
- **åŒ–å·¥æ‡‰ç”¨æ¡ˆä¾‹**ï¼š
  - **çµ‚æ¥µç²¾åº¦è¿½æ±‚**ï¼šçµåˆå¤šç¨®æ¨¡å‹çš„å„ªå‹¢
  - **ç«¶è³½èˆ‡ç ”ç©¶**ï¼šæ“ å‡ºæœ€å¾Œå¹¾å€‹ç™¾åˆ†é»çš„ç²¾åº¦
  - **æ¨¡å‹çµ„åˆç­–ç•¥**ï¼šæ•´åˆé ˜åŸŸçŸ¥è­˜æ¨¡å‹èˆ‡æ•¸æ“šé©…å‹•æ¨¡å‹
  
- **æ¼”ç®—æ³•ç‰¹æ€§**ï¼š
  - âœ… å„ªé»ï¼šç†è«–ä¸Šæ€§èƒ½ä¸Šé™æœ€é«˜ã€å……åˆ†åˆ©ç”¨æ¨¡å‹å¤šæ¨£æ€§ã€éˆæ´»æ€§æ¥µå¼·
  - âŒ ç¼ºé»ï¼šè¨“ç·´æ™‚é–“æœ€é•·ã€æ¨¡å‹è¤‡é›œåº¦é«˜ã€éƒ¨ç½²ç¶­è­·æˆæœ¬é«˜ã€éœ€è¦è¼ƒå¤šæ•¸æ“š

**é©åˆå ´æ™¯**ï¼šè¿½æ±‚çµ•å°æœ€é«˜ç²¾åº¦ã€è³‡æ–™å……è¶³ã€æœ‰å……åˆ†çš„è¨ˆç®—è³‡æº

---

### 7ï¸âƒ£ å¯¦ä½œç·´ç¿’

**æª”æ¡ˆ**ï¼š[Unit13_Ensemble_Learning_Homework.ipynb](Unit13_Ensemble_Learning_Homework.ipynb)

**ç·´ç¿’å…§å®¹**ï¼š
- æ‡‰ç”¨äº”ç¨®é›†æˆæ¨¡å‹æ–¼å¯¦éš›åŒ–å·¥æ•¸æ“š
- æ¯”è¼ƒ Random Forestã€XGBoostã€LightGBMã€CatBoostã€Stacking çš„æ€§èƒ½
- è¶…åƒæ•¸èª¿æ•´èˆ‡æ¨¡å‹å„ªåŒ–
- ç‰¹å¾µé‡è¦æ€§åˆ†æèˆ‡æ¯”è¼ƒ
- å­¸ç¿’æ›²ç·šèˆ‡éæ“¬åˆè¨ºæ–·
- é æ¸¬é€Ÿåº¦èˆ‡æ¨¡å‹å¤§å°å°æ¯”
- çµæœè§£è®€èˆ‡å·¥ç¨‹æ‡‰ç”¨å»ºè­°

---

## ğŸ“Š æ•¸æ“šé›†èªªæ˜

### 1. åŒ–å­¸è£½ç¨‹æ•¸æ“š (`data/chemical_process/`)
- è¤‡é›œçš„åŒ–å­¸è£½ç¨‹æ“ä½œæ•¸æ“šï¼ŒåŒ…å«å¤šå€‹é€£çºŒå’Œé¡åˆ¥ç‰¹å¾µ
- ç”¨æ–¼ç¤ºç¯„å„ç¨®é›†æˆæ¨¡å‹çš„è¨“ç·´èˆ‡æ¯”è¼ƒ

### 2. ä½œæ¥­æ•¸æ“š (`data/HW/`)
- ç¶œåˆç·´ç¿’æ•¸æ“šé›†
- ç”¨æ–¼å®Œæˆ Homework ç·´ç¿’

---

## ğŸ“ é›†æˆæ¨¡å‹æ¯”è¼ƒèˆ‡é¸æ“‡æŒ‡å—

| æ¨¡å‹ | ç²¾åº¦ | è¨“ç·´é€Ÿåº¦ | é æ¸¬é€Ÿåº¦ | é¡åˆ¥ç‰¹å¾µ | ç¼ºå¤±å€¼è™•ç† | èª¿åƒé›£åº¦ | è¨˜æ†¶é«”å ç”¨ | é©ç”¨å ´æ™¯ |
|------|------|---------|---------|---------|-----------|---------|-----------|----------|
| **Random Forest** | é«˜ | å¿« | å¿« | âš ï¸ | âœ… | ä½ | ä¸­ | ç©©å¥é æ¸¬ã€ç‰¹å¾µé¸æ“‡ |
| **XGBoost** | æ¥µé«˜ | ä¸­ | å¿« | âš ï¸ | âœ… | é«˜ | ä¸­ | è¿½æ±‚æ¥µè‡´ç²¾åº¦ã€ç«¶è³½ |
| **LightGBM** | æ¥µé«˜ | æ¥µå¿« | æ¥µå¿« | âœ… | âœ… | ä¸­ | å° | å¤§è¦æ¨¡æ•¸æ“šã€é€Ÿåº¦å„ªå…ˆ |
| **CatBoost** | æ¥µé«˜ | æ…¢ | å¿« | âœ…âœ… | âœ… | ä½ | å° | é¡åˆ¥ç‰¹å¾µã€å°‘èª¿åƒ |
| **Stacking** | æœ€é«˜ | æ¥µæ…¢ | æ…¢ | è¦–åŸºç¤æ¨¡å‹ | è¦–åŸºç¤æ¨¡å‹ | æ¥µé«˜ | å¤§ | çµ•å°æœ€é«˜ç²¾åº¦ |

**é¸æ“‡å»ºè­°**ï¼š
1. **ä¸€èˆ¬åŒ–å·¥é æ¸¬ä»»å‹™ï¼Œéœ€è¦ç©©å¥æ€§** â†’ Random Forest
2. **è¿½æ±‚æœ€é«˜ç²¾åº¦ï¼Œé¡˜æ„æŠ•å…¥èª¿åƒ** â†’ XGBoost
3. **å¤§è¦æ¨¡æ•¸æ“šï¼Œè¨“ç·´é€Ÿåº¦è¦æ±‚é«˜** â†’ LightGBM
4. **æœ‰é¡åˆ¥ç‰¹å¾µï¼Œå¸Œæœ›æ¸›å°‘èª¿åƒ** â†’ CatBoost
5. **çµ•å°æœ€é«˜ç²¾åº¦ï¼Œè³‡æºå……è¶³** â†’ Stacking (çµ„åˆ XGBoost + LightGBM + CatBoost)
6. **ä¸ç¢ºå®šæ™‚çš„é€šç”¨é¦–é¸** â†’ XGBoost æˆ– LightGBM

**å¿«é€Ÿæ±ºç­–æµç¨‹åœ–**ï¼š
```
æ˜¯å¦æœ‰é¡åˆ¥ç‰¹å¾µï¼Ÿ
â”œâ”€ æ˜¯ â†’ CatBoost æˆ– LightGBM
â””â”€ å¦ â†’ æ˜¯å¦å¤§æ•¸æ“šï¼ˆ>100è¬ç­†ï¼‰ï¼Ÿ
         â”œâ”€ æ˜¯ â†’ LightGBM
         â””â”€ å¦ â†’ è¿½æ±‚ç²¾åº¦ â†’ XGBoost
                 è¿½æ±‚ç©©å®š â†’ Random Forest
```

---

## ğŸ’» å¯¦ä½œç’°å¢ƒéœ€æ±‚

### å¿…è¦å¥—ä»¶
```python
numpy >= 1.21.0
pandas >= 1.3.0
matplotlib >= 3.4.0
seaborn >= 0.11.0
scikit-learn >= 1.0.0
scipy >= 1.7.0
```

### é›†æˆå­¸ç¿’å°ˆç”¨å¥—ä»¶
```python
xgboost >= 1.5.0           # XGBoost
lightgbm >= 3.3.0          # LightGBM
catboost >= 1.0.0          # CatBoost
```

### é¸ç”¨å¥—ä»¶
```python
shap >= 0.40.0             # æ¨¡å‹è§£é‡‹å·¥å…·
optuna >= 3.0.0            # è¶…åƒæ•¸å„ªåŒ–
joblib >= 1.0.0            # æ¨¡å‹å„²å­˜èˆ‡è¼‰å…¥
```

---

## ğŸ“ˆ å­¸ç¿’è·¯å¾‘å»ºè­°

### ç¬¬ä¸€éšæ®µï¼šåŸºç¤æ¦‚å¿µå»ºç«‹
1. é–±è®€ 
   - æŠ•å½±ç‰‡ [Unit13_Ensemble_Learning_Overview.pdf](Unit13_Ensemble_Learning_Overview.pdf)
   - è¬›ç¾© [Unit13_Ensemble_Learning_Overview.md](Unit13_Ensemble_Learning_Overview.md)
2. ç†è§£é›†æˆå­¸ç¿’çš„ç†è«–åŸºç¤ï¼šåå·®-æ–¹å·®åˆ†è§£ã€å¤šæ¨£æ€§åŸå‰‡
3. äº†è§£ Baggingã€Boostingã€Stacking çš„å·®ç•°

### ç¬¬äºŒéšæ®µï¼šæ¼”ç®—æ³•å­¸ç¿’èˆ‡å¯¦ä½œ
1. **Random Forest**ï¼ˆå»ºè­°æœ€å…ˆå­¸ç¿’ï¼Œæ¦‚å¿µæœ€ç°¡å–®ï¼‰
   - æŠ•å½±ç‰‡ [Unit13_Random_Forest.pdf](Unit13_Random_Forest.pdf)
   - è¬›ç¾© [Unit13_Random_Forest.md](Unit13_Random_Forest.md)
   - åŸ·è¡Œå›æ­¸ç¯„ä¾‹ [Unit13_Random_Forest_Regression.ipynb](Unit13_Random_Forest_Regression.ipynb)
   - åŸ·è¡Œåˆ†é¡ç¯„ä¾‹ [Unit13_Random_Forest_Classifier.ipynb](Unit13_Random_Forest_Classifier.ipynb)
   - é‡é»æŒæ¡ï¼šBagging åŸç†ã€ç‰¹å¾µé‡è¦æ€§ã€OOB Score
   
2. **XGBoost**ï¼ˆæœ€é‡è¦ï¼Œå¿…é ˆç²¾é€šï¼‰
   - æŠ•å½±ç‰‡ [Unit13_XGBoost.pdf](Unit13_XGBoost.pdf)
   - è¬›ç¾© [Unit13_XGBoost.md](Unit13_XGBoost.md)
   - åŸ·è¡Œå›æ­¸ç¯„ä¾‹ [Unit13_XGBoost_Regression.ipynb](Unit13_XGBoost_Regression.ipynb)
   - åŸ·è¡Œåˆ†é¡ç¯„ä¾‹ [Unit13_XGBoost_Classification.ipynb](Unit13_XGBoost_Classification.ipynb)
   - é‡é»æŒæ¡ï¼šBoosting åŸç†ã€è¶…åƒæ•¸èª¿æ•´ã€Early Stopping
   
3. **LightGBM**ï¼ˆé€Ÿåº¦å„ªå‹¢ï¼‰
   - æŠ•å½±ç‰‡ [Unit13_LightGBM.pdf](Unit13_LightGBM.pdf)
   - è¬›ç¾© [Unit13_LightGBM.md](Unit13_LightGBM.md)
   - åŸ·è¡Œå›æ­¸ç¯„ä¾‹ [Unit13_LightGBM_Regression.ipynb](Unit13_LightGBM_Regression.ipynb)
   - åŸ·è¡Œåˆ†é¡ç¯„ä¾‹ [Unit13_LightGBM_Classification.ipynb](Unit13_LightGBM_Classification.ipynb)
   - é‡é»æŒæ¡ï¼šHistogram-basedã€é¡åˆ¥ç‰¹å¾µè™•ç†
   
4. **CatBoost**ï¼ˆé¡åˆ¥ç‰¹å¾µå°ˆå®¶ï¼‰
   - æŠ•å½±ç‰‡ [Unit13_CatBoost.pdf](Unit13_CatBoost.pdf)
   - è¬›ç¾© [Unit13_CatBoost.md](Unit13_CatBoost.md)
   - åŸ·è¡Œå›æ­¸ç¯„ä¾‹ [Unit13_CatBoost_Regression.ipynb](Unit13_CatBoost_Regression.ipynb)
   - åŸ·è¡Œåˆ†é¡ç¯„ä¾‹ [Unit13_CatBoost_Classification.ipynb](Unit13_CatBoost_Classification.ipynb)
   - é‡é»æŒæ¡ï¼šOrdered Target Encodingã€é è¨­åƒæ•¸å„ªåŒ–
   
5. **Stacking**ï¼ˆé€²éšï¼šæ¨¡å‹çµ„åˆï¼‰
   - æŠ•å½±ç‰‡ [Unit13_Stacking.pdf](Unit13_Stacking.pdf)
   - è¬›ç¾© [Unit13_Stacking.md](Unit13_Stacking.md)
   - åŸ·è¡Œå›æ­¸ç¯„ä¾‹ [Unit13_Stacking_Regression.ipynb](Unit13_Stacking_Regression.ipynb)
   - åŸ·è¡Œåˆ†é¡ç¯„ä¾‹ [Unit13_Stacking_Classification.ipynb](Unit13_Stacking_Classification.ipynb)
   - é‡é»æŒæ¡ï¼šåŸºç¤å­¸ç¿’å™¨é¸æ“‡ã€å…ƒå­¸ç¿’å™¨è¨­è¨ˆ

### ç¬¬ä¸‰éšæ®µï¼šç¶œåˆæ‡‰ç”¨èˆ‡ç·´ç¿’
1. å®Œæˆ [Unit13_Ensemble_Learning_Homework.ipynb](Unit13_Ensemble_Learning_Homework.ipynb)
2. æ¯”è¼ƒäº”ç¨®é›†æˆæ¨¡å‹çš„æ€§èƒ½ã€é€Ÿåº¦ã€è¨˜æ†¶é«”å ç”¨
3. ç·´ç¿’è¶…åƒæ•¸èª¿æ•´æŠ€å·§ï¼ˆGrid Searchã€Random Searchã€Optunaï¼‰
4. åˆ†æç‰¹å¾µé‡è¦æ€§ä¸¦è§£è®€å·¥ç¨‹æ„ç¾©
5. å˜—è©¦å°‡é›†æˆæ¨¡å‹æ‡‰ç”¨æ–¼è‡ªå·±çš„åŒ–å·¥æ•¸æ“š

---

## ğŸ” åŒ–å·¥é ˜åŸŸæ ¸å¿ƒæ‡‰ç”¨

### 1. é«˜ç²¾åº¦ç”¢é‡èˆ‡å“è³ªé æ¸¬ â­
- **ç›®æ¨™**ï¼šé”åˆ°å·¥æ¥­ç´šç²¾åº¦è¦æ±‚ï¼ˆå¦‚èª¤å·® <2%ï¼‰
- **æ¨¡å‹å»ºè­°**ï¼šXGBoost æˆ– LightGBMï¼ˆç²¾åº¦é«˜ã€å¯èª¿æ€§å¼·ï¼‰
- **é—œéµæŠ€è¡“**ï¼š
  - è¶…åƒæ•¸å„ªåŒ–ï¼ˆBayesian Optimizationï¼‰
  - ç‰¹å¾µå·¥ç¨‹èˆ‡äº¤äº’ä½œç”¨æ•æ‰
  - äº¤å‰é©—è­‰èˆ‡æ³›åŒ–èƒ½åŠ›è©•ä¼°

### 2. è£½ç¨‹ç•°å¸¸èˆ‡æ•…éšœè¨ºæ–·
- **ç›®æ¨™**ï¼šæº–ç¢ºåˆ†é¡è¨­å‚™ç‹€æ…‹æˆ–æ•…éšœé¡å‹
- **æ¨¡å‹å»ºè­°**ï¼šCatBoostï¼ˆé¡åˆ¥ç‰¹å¾µè™•ç†å„ªç§€ï¼‰æˆ– XGBoost
- **é—œéµæŠ€è¡“**ï¼š
  - é¡åˆ¥ä¸å¹³è¡¡è™•ç†ï¼ˆClass Weightsã€SMOTEï¼‰
  - å¤šé¡åˆ¥åˆ†é¡è©•ä¼°ï¼ˆMacro F1ã€Confusion Matrixï¼‰
  - ç‰¹å¾µé‡è¦æ€§æ’åºï¼ˆè­˜åˆ¥é—œéµæ„Ÿæ¸¬å™¨ï¼‰

### 3. è¤‡é›œå¤šè®Šæ•¸ç³»çµ±å»ºæ¨¡
- **ç›®æ¨™**ï¼šå»ºç«‹åŒ…å«æ•¸åå€‹æ“ä½œè®Šæ•¸çš„è¤‡é›œç³»çµ±æ¨¡å‹
- **æ¨¡å‹å»ºè­°**ï¼šRandom Forestï¼ˆç©©å¥ï¼‰æˆ– LightGBMï¼ˆé«˜ç¶­æ•ˆç‡ï¼‰
- **é—œéµæŠ€è¡“**ï¼š
  - ç‰¹å¾µé¸æ“‡èˆ‡é™ç¶­
  - äº¤äº’ä½œç”¨é …è‡ªå‹•æ•æ‰
  - éƒ¨åˆ†ä¾è³´åœ– (Partial Dependence Plot) è§£è®€

### 4. å¯¦æ™‚é æ¸¬èˆ‡ç·šä¸Šç›£æ§
- **ç›®æ¨™**ï¼šå¿«é€Ÿè¨“ç·´èˆ‡å³æ™‚é æ¸¬
- **æ¨¡å‹å»ºè­°**ï¼šLightGBMï¼ˆé€Ÿåº¦æœ€å¿«ï¼‰
- **é—œéµæŠ€è¡“**ï¼š
  - æ¨¡å‹å£“ç¸®èˆ‡å„ªåŒ–
  - å¢é‡å­¸ç¿’ç­–ç•¥
  - é æ¸¬å»¶é²ç›£æ§

### 5. å¯¦é©—è¨­è¨ˆèˆ‡æœ€ä½³åŒ– â­
- **ç›®æ¨™**ï¼šçµåˆ Bayesian Optimizationï¼Œæ™ºæ…§è¨­è¨ˆå¯¦é©—
- **æ¨¡å‹å»ºè­°**ï¼šRandom Forest æˆ– XGBoostï¼ˆä½œç‚º Surrogate Modelï¼‰
- **é—œéµæŠ€è¡“**ï¼š
  - ä¸ç¢ºå®šæ€§ä¼°è¨ˆï¼ˆBootstrapï¼‰
  - Acquisition Function è¨­è¨ˆ
  - å¤šç›®æ¨™å„ªåŒ–

---

## ğŸ“ è©•ä¼°æŒ‡æ¨™ç¸½çµ

### å›æ­¸ä»»å‹™
- **RMSEã€MAEã€RÂ²**ï¼ˆèˆ‡ Unit10-11 ç›¸åŒï¼‰
- **è¨“ç·´é€Ÿåº¦**ï¼šè¨“ç·´æ™‚é–“ï¼ˆç§’ï¼‰
- **é æ¸¬é€Ÿåº¦**ï¼šæ¯ç§’é æ¸¬æ¨£æœ¬æ•¸
- **æ¨¡å‹å¤§å°**ï¼šå„²å­˜ç©ºé–“ï¼ˆMBï¼‰

### åˆ†é¡ä»»å‹™
- **Accuracyã€F1ã€ROC-AUC**ï¼ˆèˆ‡ Unit12 ç›¸åŒï¼‰
- **å¤šé¡åˆ¥æŒ‡æ¨™**ï¼šMacro/Micro F1ã€Confusion Matrix

### é›†æˆå­¸ç¿’ç‰¹æ®Šè©•ä¼°
- **éæ“¬åˆç¨‹åº¦**ï¼šè¨“ç·´é›†èˆ‡æ¸¬è©¦é›†æ€§èƒ½å·®è·
- **ç‰¹å¾µé‡è¦æ€§ç©©å®šæ€§**ï¼šå¤šæ¬¡è¨“ç·´çš„ä¸€è‡´æ€§
- **è¶…åƒæ•¸æ•æ„Ÿåº¦**ï¼šåƒæ•¸è®ŠåŒ–å°æ€§èƒ½çš„å½±éŸ¿
- **çµ„åˆæ”¶ç›Š**ï¼šStacking ç›¸è¼ƒæ–¼æœ€ä½³å–®ä¸€æ¨¡å‹çš„æå‡

---

## ğŸš€ é€²éšå­¸ç¿’æ–¹å‘

å®Œæˆæœ¬å–®å…ƒå¾Œï¼Œå¯ä»¥é€²ä¸€æ­¥æ¢ç´¢ï¼š

1. **è¶…åƒæ•¸è‡ªå‹•å„ªåŒ–**ï¼šOptunaã€Hyperoptã€Bayesian Optimization
2. **æ¨¡å‹è§£é‡‹å·¥å…·**ï¼šSHAPã€LIMEã€TreeExplainer
3. **æ·±åº¦å­¸ç¿’é›†æˆ**ï¼šDeep Forestã€Neural Network Ensemble
4. **AutoML æ¡†æ¶**ï¼šAuto-sklearnã€TPOTã€H2O AutoML
5. **æ¨¡å‹å£“ç¸®èˆ‡éƒ¨ç½²**ï¼šONNXã€TensorFlow Liteã€æ¨¡å‹è’¸é¤¾
6. **æ™‚é–“åºåˆ—é›†æˆ**ï¼šProphet + LSTM + XGBoost çµ„åˆ

---

## ğŸ“š åƒè€ƒè³‡æº

### æ•™ç§‘æ›¸
1. *The Elements of Statistical Learning* by Hastie, Tibshirani, Friedman (ç¬¬ 15, 16 ç« )
2. *Introduction to Machine Learning with Python* by MÃ¼ller & Guido (ç¬¬ 2 ç«  Ensemble Methods)

### å®˜æ–¹æ–‡ä»¶
- [XGBoost å®˜æ–¹æ–‡ä»¶](https://xgboost.readthedocs.io/)
- [LightGBM å®˜æ–¹æ–‡ä»¶](https://lightgbm.readthedocs.io/)
- [CatBoost å®˜æ–¹æ–‡ä»¶](https://catboost.ai/docs/)

### ç·šä¸Šè³‡æº
- [Kaggle Ensembling Guide](https://www.kaggle.com/getting-started/)
- [XGBoost vs LightGBM vs CatBoost å°æ¯”](https://towardsdatascience.com/)

### åŒ–å·¥é ˜åŸŸæ‡‰ç”¨è«–æ–‡
- é›†æˆå­¸ç¿’åœ¨è£½ç¨‹é æ¸¬èˆ‡å„ªåŒ–ä¸­çš„æ‡‰ç”¨
- åŒ–å·¥æ•¸æ“šç§‘å­¸çš„æ©Ÿå™¨å­¸ç¿’æ–¹æ³•ç¶œè¿°

---

## âœï¸ èª²å¾Œç¿’é¡Œæç¤º

1. **æ¨¡å‹å°æ±º**ï¼šåœ¨åŒä¸€æ•¸æ“šé›†ä¸Šæ¯”è¼ƒäº”ç¨®é›†æˆæ¨¡å‹çš„ç²¾åº¦ã€é€Ÿåº¦ã€è¨˜æ†¶é«”
2. **è¶…åƒæ•¸èª¿æ•´**ï¼šä½¿ç”¨ Grid Search æˆ– Optuna å„ªåŒ– XGBoost è¶…åƒæ•¸
3. **ç‰¹å¾µé‡è¦æ€§åˆ†æ**ï¼šæ¯”è¼ƒä¸åŒæ¨¡å‹çµ¦å‡ºçš„ç‰¹å¾µé‡è¦æ€§æ’åº
4. **Stacking å¯¦é©—**ï¼šçµ„åˆ XGBoost + LightGBM + CatBoostï¼Œè©•ä¼°æå‡å¹…åº¦
5. **åŒ–å·¥æ‡‰ç”¨**ï¼šå°‡æœ€ä½³é›†æˆæ¨¡å‹æ‡‰ç”¨æ–¼å¯¦éš›åŒ–å·¥æ•¸æ“šï¼Œé”åˆ°å·¥æ¥­è¦æ±‚ç²¾åº¦

---

## ğŸ“ æŠ€è¡“æ”¯æ´

å¦‚æœ‰ç–‘å•æˆ–éœ€è¦å”åŠ©ï¼Œæ­¡è¿é€éä»¥ä¸‹æ–¹å¼è¯ç¹«ï¼š
- èª²ç¨‹è¨è«–å€
- æŒ‡å°æ•™æˆ Office Hour
- èª²ç¨‹åŠ©æ•™

---

**ç‰ˆæœ¬è³‡è¨Š**ï¼šUnit13 v1.0 | æœ€å¾Œæ›´æ–°ï¼š2026-01-27

**ğŸ‰ æ­å–œå®Œæˆé›†æˆå­¸ç¿’å–®å…ƒï¼æ‚¨å·²æŒæ¡ç›®å‰å·¥æ¥­ç•Œæœ€å¯¦ç”¨çš„æ©Ÿå™¨å­¸ç¿’æŠ€è¡“ï¼**
